<!-- Client Applications Modal -->
<div id="clientAppsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; align-items: center; justify-content: center;">
<div style="background: white; border-radius: 12px; padding: 30px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
<div>
<h2 id="clientAppsModalTitle" style="color: #333; margin: 0 0 5px 0;">Client Applications</h2>
<p id="clientAppsModalSubtitle" style="color: #666; margin: 0; font-size: 0.9em;">Loading...</p>
</div>
<button id="closeClientAppsModalBtn" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1;">&times;</button>
</div>

<div id="clientAppsLoading" style="text-align: center; padding: 40px;">
<div style="margin: 0 auto 20px auto; width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #ff6600; border-radius: 50%; animation: spin 1s linear infinite;"></div>
<p style="color: #666;">Loading application data...</p>
</div>

<div id="clientAppsContent" style="display: none;">
<!-- Summary Stats -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px;">
<div style="background: linear-gradient(135deg, #FA582D 0%, #E04F26 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Total Sessions</div>
<div id="clientAppsTotalSessions" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
<div style="background: linear-gradient(135deg, #C64620 0%, #AD3D1A 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Total Data</div>
<div id="clientAppsTotalData" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
<div style="background: linear-gradient(135deg, #AD3D1A 0%, #933414 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Applications</div>
<div id="clientAppsCount" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
</div>

<!-- Applications Table -->
<div style="background: #f9f9f9; border-radius: 8px; padding: 15px;">
<h3 style="margin: 0 0 15px 0; color: #333; font-size: 1.1em;">Top Applications</h3>
<div id="clientAppsTable"></div>
</div>
</div>

<div id="clientAppsError" style="display: none; padding: 20px; background: #fee2e2; color: #991b1b; border-radius: 8px; text-align: center;">
Error loading application data
</div>
</div>
</div>

<!-- Application Details Modal -->
<div id="appDetailsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; align-items: center; justify-content: center;">
<div style="background: white; border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
<div>
<h2 id="appDetailsModalTitle" style="color: #333; margin: 0 0 5px 0;">Application Details</h2>
<p id="appDetailsModalSubtitle" style="color: #666; margin: 0; font-size: 0.9em;">Detailed traffic information</p>
</div>
<button id="closeAppDetailsModalBtn" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1;">&times;</button>
</div>

<div id="appDetailsLoading" style="text-align: center; padding: 40px;">
<div style="margin: 0 auto 20px auto; width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #ff6600; border-radius: 50%; animation: spin 1s linear infinite;"></div>
<p style="color: #666;">Loading application details...</p>
</div>

<div id="appDetailsContent" style="display: none;">
<!-- Summary Stats -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 25px;">
<div style="background: linear-gradient(135deg, #FA582D 0%, #E04F26 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Total Sessions</div>
<div id="appDetailsSessions" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
<div style="background: linear-gradient(135deg, #C64620 0%, #AD3D1A 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Total Volume</div>
<div id="appDetailsTotalBytes" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
<div style="background: linear-gradient(135deg, #AD3D1A 0%, #933414 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Source IPs</div>
<div id="appDetailsSourcesCount" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
<div style="background: linear-gradient(135deg, #933414 0%, #7A2B0E 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Destinations</div>
<div id="appDetailsDestsCount" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
</div>

<!-- Source IPs Table -->
<div style="background: #f9f9f9; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
<h3 style="margin: 0 0 15px 0; color: #333; font-size: 1.1em;">Source IP Addresses</h3>
<div id="appDetailsSourceIPs" style="max-height: 300px; overflow-y: auto;"></div>
</div>

<!-- Additional Details -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
<div style="background: #f9f9f9; border-radius: 8px; padding: 15px;">
<h4 style="margin: 0 0 10px 0; color: #666; font-size: 0.9em; text-transform: uppercase;">Protocols</h4>
<div id="appDetailsProtocols" style="font-family: 'Courier New', monospace; color: #333; font-size: 0.95em;">-</div>
</div>
<div style="background: #f9f9f9; border-radius: 8px; padding: 15px;">
<h4 style="margin: 0 0 10px 0; color: #666; font-size: 0.9em; text-transform: uppercase;">Top Ports</h4>
<div id="appDetailsPorts" style="font-family: 'Courier New', monospace; color: #333; font-size: 0.95em;">-</div>
</div>
<div style="background: #f9f9f9; border-radius: 8px; padding: 15px;">
<h4 style="margin: 0 0 10px 0; color: #666; font-size: 0.9em; text-transform: uppercase;">VLANs</h4>
<div id="appDetailsVlans" style="font-family: 'Courier New', monospace; color: #333; font-size: 0.95em;">-</div>
</div>
</div>
</div>

<div id="appDetailsError" style="display: none; padding: 20px; background: #fee2e2; color: #991b1b; border-radius: 8px; text-align: center;">
Error loading application details
</div>
</div>
</div>

<!-- Category Destinations Modal -->
<div id="categoryDestinationsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; align-items: center; justify-content: center;">
<div style="background: white; border-radius: 12px; padding: 30px; max-width: 1000px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #FA582D; padding-bottom: 15px;">
<div>
<h2 id="categoryDestinationsModalTitle" style="color: #333; margin: 0 0 5px 0;">Destination IP Addresses</h2>
<p id="categoryDestinationsModalSubtitle" style="color: #666; margin: 0; font-size: 0.9em;">Traffic destinations</p>
</div>
<button id="closeCategoryDestinationsModalBtn" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #999; line-height: 1;">&times;</button>
</div>

<div id="categoryDestinationsContent">
<!-- Summary Stats -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 25px;">
<div style="background: linear-gradient(135deg, #FA582D 0%, #E04F26 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Application</div>
<div id="categoryDestApp" style="font-size: 1.5em; font-weight: 700; word-break: break-word;">-</div>
</div>
<div style="background: linear-gradient(135deg, #C64620 0%, #AD3D1A 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Total Destinations</div>
<div id="categoryDestCount" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
<div style="background: linear-gradient(135deg, #AD3D1A 0%, #933414 100%); border-radius: 8px; padding: 15px; color: white;">
<div style="font-size: 0.8em; opacity: 0.9; margin-bottom: 5px;">Total Volume</div>
<div id="categoryDestVolume" style="font-size: 1.8em; font-weight: 700;">-</div>
</div>
</div>

<!-- Destinations List -->
<div style="background: #f9f9f9; border-radius: 8px; padding: 20px;">
<h3 style="margin: 0 0 15px 0; color: #333; font-size: 1.1em;">Destination IP Addresses / Hosts</h3>
<div id="categoryDestinationIPs" style="max-height: 400px; overflow-y: auto;"></div>
</div>
</div>
</div>
</div>

<!-- Connected Devices Content -->
<div id="connected-devices-content" class="page-content" style="display: none;">
<div class="container">
<div class="header" style="text-align: left; margin-bottom: 30px;">
<h1 style="color: #ffffff; font-size: 1.8em; font-weight: 700; margin: 0 0 5px 0;">Connected Devices</h1>
<p style="color: #FA582D; font-size: 0.9em; margin: 0;">Devices Connected to the Firewall Network</p>
</div>

<div class="error-message" id="connectedDevicesErrorMessage"></div>

<!-- Search and Filter Bar -->
<div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-top: 3px solid #FA582D;">
<div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
<div>
<label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">General Search</label>
<input type="text"
id="connectedDevicesSearchInput"
placeholder="Search by hostname, IP, MAC, vendor..."
style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; transition: border-color 0.3s;"
onfocus="this.style.borderColor='#FA582D'"
onblur="this.style.borderColor='#ddd'"
/>
</div>
<div>
<label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">VLAN Filter</label>
<select id="connectedDevicesVlanFilter" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer; transition: border-color 0.3s;" onfocus="this.style.borderColor='#ff6600'" onblur="this.style.borderColor='#ddd'">
<option value="">All VLANs</option>
<!-- Will be populated dynamically -->
</select>
</div>
<div>
<label style="display: block; color: #333; font-weight: 600; margin-bottom: 5px; font-size: 0.9em;">Status Filter</label>
<select id="connectedDevicesStatusFilter" style="width: 100%; padding: 10px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.95em; cursor: pointer; transition: border-color 0.3s;" onfocus="this.style.borderColor='#ff6600'" onblur="this.style.borderColor='#ddd'">
<option value="">All Status</option>
<option value="active">Active</option>
<option value="c">Complete</option>
<option value="active_session">Active Session</option>
<option value="learned">Learned</option>
</select>
</div>
</div>
<div style="display: flex; align-items: center; justify-content: space-between; gap: 15px; flex-wrap: wrap;">
<div style="display: flex; align-items: center; gap: 15px;">
<div style="display: flex; align-items: center; gap: 8px;">
<label style="color: #333; font-weight: 600; font-size: 0.9em;">Show:</label>
<select id="connectedDevicesLimit" style="padding: 8px 12px; border: 2px solid #ddd; border-radius: 6px; background: white; color: #333; font-size: 0.9em; cursor: pointer;">
<option value="10">10 devices</option>
<option value="25">25 devices</option>
<option value="50" selected>50 devices</option>
<option value="100">100 devices</option>
<option value="250">250 devices</option>
<option value="500">500 devices</option>
<option value="-1">All devices</option>
</select>
</div>
<button id="refreshConnectedDevicesBtn" style="padding: 8px 16px; background: linear-gradient(135deg, #FA582D 0%, #C64620 100%); color: white; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
Refresh
</button>
</div>
<div style="display: flex; gap: 10px;">
<button id="exportDevicesCSV" style="padding: 8px 16px; background: linear-gradient(135deg, #C64620 0%, #AD3D1A 100%); color: white; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
Export CSV
</button>
<button id="exportDevicesXML" style="padding: 8px 16px; background: linear-gradient(135deg, #AD3D1A 0%, #933414 100%); color: white; border: none; border-radius: 6px; font-size: 0.85em; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
Export XML
</button>
</div>
</div>
</div>

<div id="connectedDevicesTable"></div>
</div>
</div>
